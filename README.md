這是一份為您的 **TWIoT PM2.5 v3.2.7 科技巡檢全功能版** 量身打造的 `README.md`。它完整涵蓋了從 v3.2.0 繼承的大數據核心技術，以及這次升級的人文引擎與科技感定位特效。

---

# TWIoT PM2.5 科技巡檢系統 (v3.2.7)

## 📋 系統簡介

本系統是一款專為 2026 年環境監測設計的物聯網（IoT）可視化平台。系統深度整合了全台微型感測器數據，提供高頻率、分頁遞迴抓取的 PM2.5 即時監測。

在 **v3.2.7** 版本中，我們優化了導航定位的視覺體驗，並強化了「人文引擎」，使其成為兼具技術深度與在地關懷的智慧巡檢工具。

---

## 🚀 核心功能與升級亮點

### 1. 2026 人文巡檢引擎 [繼承 v3.2.0 並擴充]

* **全年度節慶偵測**：預載 2026 年行政院人事行政總處公布之國定假日（如除夕 1/28、中秋 9/25）。
* **二十四節氣同步**：完整收錄從小寒、立春到冬至的 24 個節氣精確日期。
* **動態祝禱系統**：開場煙火視窗會根據當前日期自動變換祝福文字（例如立春當天顯示「2026 立春大吉」）。
* **倒數計時器**：即時計算距離 2027 年的剩餘時間。

### 2. 科技感定位特效 (方案 B 優化版)

* **雙層泛光圈**：點擊定位按鈕後，透過 CSS `::before` 與 `::after` 觸發兩層藍色雷達擴散動畫，具備強烈的掃描感。
* **雷達標記圖示**：定位成功後，在地圖上生成一個具備呼吸燈脈衝（Pulse Ring）效果的科技點位圖標。
* **無視窗衝突**：修復了 CSS 層疊上下文問題，確保定位特效開啟時不會干擾煙火開場視窗的點擊與渲染。

### 3. 大數據遞迴抓取技術 [v3.2.0 核心]

* **非阻塞式遞迴**：利用 `while(nextURL)` 邏輯完整抓取全台超過 8,000 個測站數據，確保數據零遺漏。
* **自動運鏡輪播**：具備自動巡檢模式，每 5 秒依空氣品質等級自動切換視角與篩選。
* **雙向聯動圖表**：Chart.js 統計圖表與地圖實體標記雙向綁定，點擊圖表即可過濾地圖點位。

---

## 🛠 技術架構

* **Frontend**: HTML5, CSS3 (Advanced Animations)
* **Mapping**: Leaflet.js (L.circleMarker & L.divIcon)
* **Data Analysis**: Chart.js (Logarithmic Scaling)
* **Data Source**: 行政院環保署 IoT 開放平台 API

---

## 📂 檔案結構

* `index.html`: 系統骨架，包含煙火模態框、地圖容器及儀表板佈局。
* `styles.css`: 包含全套 2026 科技感樣式、定位脈衝動畫及行動端適配邏輯。
* `scripts.js`: 核心邏輯層，負責 API 數據抓取、人文時鐘計算、節氣判定及圖表交互。

---

## 🔧 安裝與使用

1. 下載本專案所有檔案（`index.html`, `styles.css`, `scripts.js`）至同一目錄。
2. 使用瀏覽器（建議 Chrome 或 Edge）開啟 `index.html`。
3. **定位說明**：若要觸發科技感定位特效，請點擊右側儀表板的 **📍 定位** 按鈕，並於瀏覽器彈窗中允許位置存取授權。

---

## 📝 版本更新紀錄

* **v3.2.0**: 黃金穩定版，導入人文時鐘與分頁抓取機制。
* **v3.2.7**: 導入「方案 B」科技定位特效，擴充 2026 年完整國定假日與 24 節氣清單。

---
